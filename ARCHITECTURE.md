# Project Architecture

## Overview
This document outlines the optimized architecture of the CS491 Format and Style Checker project after consolidation.

## Directory Structure

```
CS491_Format_and_Style_Checker/
├── src/                                    # Main Word Add-in source code
│   ├── commands/                           # Office.js command handlers
│   │   ├── commands.html                   # Commands UI (minimal)
│   │   └── commands.js                     # Command execution logic
│   │
│   └── taskpane/                          # Task pane application
│       ├── components/                     # React UI components
│       │   └── App.jsx                     # Main app with all checker sections
│       │
│       ├── config/                         # Configuration files
│       │   └── rules.json                  # Validation rules and criteria
│       │
│       ├── checkHeaderFooterFormatting.js  # Header/footer validation + auto-fix
│       ├── checkStyles.js                   # Style consistency validation
│       ├── docChecks.js                     # Document structure checks
│       ├── symbolChecks.js                  # Symbol font validation + auto-fix
│       ├── wordChecks.js                    # General formatting checks
│       ├── index.jsx                        # React app entry point
│       ├── taskpane.html                    # Task pane HTML template
│       └── taskpane.js                      # Task pane initialization
│
├── assets/                                 # Static assets
│   ├── icon-*.png                          # Add-in icons (various sizes)
│   └── logo-filled.png                     # Logo asset
│
├── dist/                                   # Build output (generated by webpack)
│
├── app.py                                  # Flask web interface (separate tool)
├── static/                                 # Flask static files (CSS, JS)
├── templates/                              # Flask HTML templates
│
├── manifest.xml                            # Office Add-in manifest
├── webpack.config.js                       # Build configuration
├── babel.config.json                       # Babel transpiler config
├── tsconfig.json                          # TypeScript configuration
├── package.json                            # Node.js dependencies
└── .eslintrc.json                         # ESLint configuration
```

## Component Architecture

### Word Add-in (Primary Application)
**Entry Point:** `src/taskpane/index.jsx`

**Main Component:** `src/taskpane/components/App.jsx`
- Comprehensive checker sections (7 total):
  1. Comprehensive Checker (combines all checks)
  2. Formatting Checker
  3. Header/Footer Checker (with auto-fix)
  4. Document Checker
  5. Styles Checker
  6. Symbols Checker (with auto-fix)

**Check Modules:**
- `wordChecks.js` - Formatting validation (highlighting, fonts, colors, etc.)
- `docChecks.js` - Document structure (comments, watermarks, margins, page size)
- `checkStyles.js` - Style consistency (captions, bookmarks, numbering)
- `checkHeaderFooterFormatting.js` - Header/footer validation + fix functions
- `symbolChecks.js` - Symbol font validation + fix functions

**Configuration:**
- `config/rules.json` - Centralized validation rules

### Flask Web Interface (Secondary Tool)
**Entry Point:** `app.py`
- Separate spell-checking web interface
- Uses PyPDF2 and python-docx for document parsing
- Static files in `static/`, templates in `templates/`

## Data Flow

```
User Action (UI Click)
    ↓
App.jsx Handler (e.g., handleRunHeaderFooterCheck)
    ↓
Check Function (e.g., checkHeaderFooterFormatting)
    ↓
Word.run() → Office.js API
    ↓
Validation Logic + rules.json
    ↓
Results Array
    ↓
Set State (e.g., setHeaderFooterResults)
    ↓
UI Update (display results with Fix buttons)
    ↓
[Optional] Fix Handler (e.g., handleFixSingleIssue)
    ↓
Fix Function (e.g., fixHeaderFooterIssue)
    ↓
Word.run() → Apply changes via Office.js
    ↓
Re-run check to update results
```

## Build Process

1. **Development:** `npm run build:dev`
   - Webpack bundles source files
   - Source maps enabled for debugging
   - Output to `dist/`

2. **Production:** `npm run build`
   - Minified bundles
   - Optimized for deployment

3. **Dev Server:** `npm run dev-server`
   - Live reload at https://localhost:3000
   - Self-signed certificates for Office Add-in

4. **Debug Word:** `npm run start -- desktop --app word`
   - Launches Word with add-in sideloaded

## Key Dependencies

### Runtime
- `react` + `react-dom` - UI framework
- `@fluentui/react-components` - Microsoft Fluent UI
- Office.js - Microsoft Office JavaScript API

### Build Tools
- `webpack` - Module bundler
- `babel` - JavaScript transpiler
- `office-addin-dev-certs` - Development SSL certificates

## Recent Optimizations (Dec 2024)

1. **Removed duplicate FormatStylerChecker folder** - Eliminated redundant code
2. **Consolidated to single src/ directory** - Clearer structure
3. **Separated concerns** - Flask app vs Word add-in clearly delineated
4. **Auto-fix functionality** - Added to Headers/Footers and Symbols checkers
5. **Improved UX** - Loading states, success messages, individual + bulk fixes

## Development Guidelines

1. **All Word Add-in code goes in `src/`**
2. **Check modules are independent** - Each checker has its own file
3. **Rules are centralized** - Modify `config/rules.json` for validation criteria
4. **Fix functions follow pattern** - Return `{ success: boolean, message: string }`
5. **UI updates via React state** - No direct DOM manipulation
